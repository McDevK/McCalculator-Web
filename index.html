<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QQ14 生产计算器</title>
    
    <!-- Favicon 图标 -->
    <link rel="icon" type="image/webp" sizes="16x16" href="assets/icons/favicon/favicon.webp">
    <link rel="icon" type="image/webp" sizes="32x32" href="assets/icons/favicon/favicon.webp">
    <link rel="icon" type="image/webp" sizes="48x48" href="assets/icons/favicon/favicon.webp">
    <link rel="icon" type="image/webp" sizes="64x64" href="assets/icons/favicon/favicon.webp">
    <link rel="icon" type="image/webp" sizes="128x128" href="assets/icons/favicon/favicon.webp">
    <link rel="icon" type="image/webp" sizes="256x256" href="assets/icons/favicon/favicon.webp">
    <link rel="apple-touch-icon" href="assets/icons/favicon/favicon.webp">
    <link rel="shortcut icon" href="assets/icons/favicon/favicon.webp">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-hammer"></i>
                <span>QQ14 生产计算器</span>
            </div>
            <div class="header-right">
                <!-- 艾欧泽亚时钟显示 -->
                <div id="eorzeaTimeBox" class="local-time-box">
                    <span class="local-time-label">艾</span>
                    <span class="local-time-value" id="eorzeaTimeValue">00:00</span>
                </div>
                <!-- 本地时间显示 -->
                <div id="localTimeBox" class="local-time-box">
                    <span class="local-time-label">本</span>
                    <span class="local-time-value" id="localTimeValue">00:00</span>
                </div>
                <!-- 桌面/移动端切换按钮 -->
                <button class="device-toggle" id="deviceToggle" title="切换到移动端">
                    <img src="assets/icons/button/mobile.png" alt="移动端" class="device-icon">
                </button>
                <!-- 主题切换按钮 -->
                <button class="theme-toggle" id="themeToggle" title="切换主题">
                    <i class="fas fa-moon"></i>
                </button>
                <!-- 作者信息 -->
                <div class="author-info">
                    <!-- 麦满分🌸黄金谷 麦当劳🌸黄金谷-->
                </div>
            </div>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <main class="main-content">
        <!-- 计算器页面 -->
        <div class="tab-content active" id="calculator">
            <div class="calculator-container">
            <!-- 左侧：职业选择侧边栏 -->
            <aside class="job-sidebar">
                <button class="job-tab" data-job="quickcalc">
                    <img src="assets/icons/jobs/001.webp" alt="快捷计算" class="job-icon">
                    快捷计算
                </button>
                <button class="job-tab" data-job="carpenter">
                    <img src="assets/icons/jobs/002.webp" alt="刻木匠" class="job-icon">
                    刻木匠
                </button>
                <button class="job-tab" data-job="blacksmith">
                    <img src="assets/icons/jobs/003.webp" alt="锻铁匠" class="job-icon">
                    锻铁匠
                </button>
                <button class="job-tab" data-job="armorer">
                    <img src="assets/icons/jobs/004.webp" alt="铸甲匠" class="job-icon">
                    铸甲匠
                </button>
                <button class="job-tab" data-job="goldsmith">
                    <img src="assets/icons/jobs/005.webp" alt="雕金匠" class="job-icon">
                    雕金匠
                </button>
                <button class="job-tab" data-job="leatherworker">
                    <img src="assets/icons/jobs/006.webp" alt="制革匠" class="job-icon">
                    制革匠
                </button>
                <button class="job-tab" data-job="weaver">
                    <img src="assets/icons/jobs/007.webp" alt="裁衣匠" class="job-icon">
                    裁衣匠
                </button>
                <button class="job-tab" data-job="alchemist">
                    <img src="assets/icons/jobs/008.webp" alt="炼金术士" class="job-icon">
                    炼金术士
                </button>
                <button class="job-tab" data-job="culinarian">
                    <img src="assets/icons/jobs/009.webp" alt="烹调师" class="job-icon">
                    烹调师
                </button>
                <button class="job-tab" data-job="miner">
                    <img src="assets/icons/jobs/010.webp" alt="采矿工" class="job-icon">
                    采矿工
                </button>
                <button class="job-tab" data-job="botanist">
                    <img src="assets/icons/jobs/011.webp" alt="园艺工" class="job-icon">
                    园艺工
                </button>
                <!-- 捕鱼人职业暂未使用，已隐藏 -->
                <!-- <button class="job-tab" data-job="fisher">
                    <img src="assets/icons/jobs/012.webp" alt="捕鱼人" class="job-icon">
                    捕鱼人
                </button> -->
            </aside>
            <!-- 中间：物品选择区域 -->
            <div class="item-selection">
                <div class="section-header">
                    <div class="search-actions">
                        <button class="btn btn-fav-toggle" id="favToggleBtn" title="只看收藏"><i class="fas fa-star"></i></button>
                        <button class="btn btn-alarm-toggle" id="alarmToggleBtn" title="只看闹钟" style="display: none;"><i class="fas fa-clock"></i></button>
                        <div class="search-box">
                            <input type="text" id="itemSearch" placeholder="搜索物品名称...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                </div>
                <div class="items-grid" id="itemsGrid">
                    <!-- 物品将通过JavaScript动态加载 -->
                </div>
            </div>
            <!-- 右侧：计算结果区域 -->
            <div class="calculation-results">
                <div class="section-header">
                    <h2><i class="fas fa-chart-bar"></i> 计算结果</h2>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <button class="btn btn-primary" id="clearSelectedBtn" title="清空已选物品">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="btn" id="exportExcelBtn" title="导出Excel" aria-label="导出Excel">
                            <i class="fas fa-file-export"></i>
                        </button>
                        <button class="btn btn-primary" id="calculateBtn">
                            <i class="fas fa-calculator"></i> <span class="calculate-btn-text">计算素材</span>
                        </button>
                    </div>
                </div>
                
                <!-- 生产职业内容 -->
                <div class="production-content">
                    <div class="selected-items">
                        <h3>已选物品 <small style="color: var(--ff14-text-secondary); font-size: 12px;">(点击物品名称标记完成)</small></h3>
                        <div class="selected-items-list" id="selectedItemsList">
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <p>请选择要制造的物品</p>
                            </div>
                        </div>
                    </div>
                    <div class="materials-needed">
                        <h3>半成品 <small style="color: var(--ff14-text-secondary); font-size: 12px;">(点击物品名称标记完成)</small></h3>
                        <div class="materials-list" id="materialsList">
                            <div class="empty-state">
                                <i class="fas fa-boxes"></i>
                                <p>点击计算按钮查看所需素材</p>
                            </div>
                        </div>
                    </div>
                    <div class="base-materials-needed">
                        <h3>基础材料 <small style="color: var(--ff14-text-secondary); font-size: 12px;">(点击物品名称标记完成)</small></h3>
                        <div class="base-materials-list" id="baseMaterialsList">
                            <div class="empty-state">
                                <i class="fas fa-boxes"></i>
                                <p>点击计算按钮查看基础材料</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 采集职业闹钟内容 -->
                <div class="alarm-content" style="display: none;">
                    <div class="alarm-list">
                        <!-- <h3>闹钟列表</h3>  // 采集职业下方标签已隐藏或删除 -->
                        <div class="alarm-items-list" id="alarmItemsList">
                            <div class="empty-state">
                                <i class="fas fa-clock"></i>
                                <p>请添加闹钟提醒的物品</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
        
        <!-- 收藏页面 -->
        <div class="tab-content" id="favorites">
            <div class="favorites-container">
                <h2><i class="fas fa-heart"></i> 收藏的物品</h2>
                <div class="favorites-list" id="favoritesList">
                    <div class="empty-state">
                        <i class="fas fa-heart-broken"></i>
                        <p>暂无收藏的物品</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 版权信息 -->
    <footer class="footer">
        <div class="footer-divider"></div>
        <div class="footer-content">
            <div class="footer-info">
                <p>&copy; 2025 QQ14 生产计算器 | 麦满分🌸黄金谷  麦当劳🌸黄金谷</p>
                <p>基于 最终幻想14水晶世界 制作系统数据 | 仅供学习交流使用</p>
            </div>
            <div class="footer-links">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </footer>

    <!-- 库存管理弹窗 -->
    <div class="modal" id="inventoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>库存管理</h3>
                <button class="modal-close" id="inventoryModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="inventory-input">
                    <input type="text" id="inventorySearch" placeholder="搜索素材...">
                    <div class="inventory-list" id="inventoryList">
                        <!-- 库存列表将通过JavaScript动态加载 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="device-detector.js"></script>
    <script src="script.js"></script>
    <script src="cache-manager.js"></script>
    <script>
      // 注册Service Worker用于缓存
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // 使用相对路径注册Service Worker
          navigator.serviceWorker.register('./sw.js')
            .then(registration => {
              console.log('SW registered: ', registration);
              // 预缓存配方数据
              if (registration.active) {
                registration.active.postMessage({ type: 'PRECACHE_RECIPES' });
              }
            })
            .catch(registrationError => {
              // 静默处理注册错误，避免控制台报错
              console.log('Service Worker registration failed:', registrationError);
            });
        });
      }
    </script>
</body>
</html> 